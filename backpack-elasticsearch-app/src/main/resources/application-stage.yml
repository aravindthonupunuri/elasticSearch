micronaut:
  application:
    name: backpack-elasticsearch-app
  server:
    host: ${backpack-elasticsearch-app-host:localhost}
    port: 8081
    idle-timeout: 2000ms
  http:
    client.connect-ttl: 30m
    client.pool.acquire-timeout: 2000ms
    services:
      permissions-api:
        urls:
          - "https://listspermissions.dev.target.com"
        connect-timeout: 300ms
        read-timeout: 300ms
        pool:
          enabled: true
          max-connections: 128
          max-pending-acquires: 50
  metrics:
    binders:
      web:
        enabled: false # we are using our own binder via our custom micronaut-metrics lib

filter:
  server:
    order:
      mdc-filter: 50
      lists-brave-tracing-server-filter: 100
      list-authorization-filter: 200
      registry-channel-subchannel-filter: 400
  client:
    order:
      lists-brave-tracing-client-filter: 900
      metrics-filter: 850
      resilience-client-filter: 800
      oauth-filter: 701
      oauth-key-filter: 700

msgbus:
  source: backpackelasticsearch
  dlq-source: backpackelasticsearch-dlq
  kafka:
    consumer:
      enabled: false
    producer:
      enabled: false
      client-id: backpack-elasticsearch-data-bus-stage-producer
    dlqconsumer:
      enabled: false
    dlqproducer:
      enabled: false
      client-id: backpack-elasticsearch-data-bus-stage-dlq-producer
    topic: registry-internal-data-bus-stage
    consumer-group: backpack-elasticsearch-data-bus-stage-consumer
    consumer-batch-size: 10
    dlq-topic: registry-internal-data-bus-stage-dlq
    dlq-consumer-group: backpack-elasticsearch-data-bus-stage-dlq-consumer
    dlq-event-retry-interval-secs: 1
    dlq-max-event-retry-count: 2
    dlq-consumer-batch-size: 10

kafka:
  bootstrap:
    servers: ${kafkaenv.servers}
  ssl:
    endpoint.identification.algorithm: ""# disable karka broker cert's hostname verification
    keystore:
      location: /lists-bus-keystore.jks
      password: ${kafka-secret.keystore-password}
    truststore:
      location: /client-truststore.jks
      password: ${kafka-secret.truststore-password}
      type: PKCS12
  security:
    protocol: ssl
